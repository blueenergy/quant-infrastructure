# MongoDB 6.0 配置文件
# 优化用于 4GB 内存机器

# ========================
# 存储配置
# ========================
storage:
  dbPath: /data/db
  journal:
    enabled: true
  wiredTiger:
    engineConfig:
      cacheSizeGB: 0.8              # 限制缓存到 800MB
      journalCompressor: snappy     # 日志压缩
    collectionConfig:
      blockCompressor: zstd         # 数据压缩 (zstd 效率更高)
    indexConfig:
      prefixCompression: true       # 索引前缀压缩

# ========================
# 日志配置
# ========================
systemLog:
  destination: file
  path: /var/log/mongodb/mongod.log
  logAppend: true
  verbosity: 0                      # 减少日志详细程度 (0=info, 1=debug)
  quiet: false
  timeStampFormat: iso8601-local

# ========================
# 网络配置
# ========================
net:
  port: 27017
  bindIp: 0.0.0.0                   # 监听所有网络接口
  maxIncomingConnections: 100       # 限制最大连接数
  wireObjectCheck: true
  ipv6: false

# ========================
# 安全配置
# ========================
security:
  authorization: enabled

# ========================
# 性能分析
# ========================
operationProfiling:
  mode: slowOp                      # 只记录慢查询
  slowOpThresholdMs: 500            # 超过 500ms 记录为慢查询
  slowOpSampleRate: 1.0             # 采样率 100%

# ========================
# 进程管理
# ========================
processManagement:
  timeZoneInfo: /usr/share/zoneinfo

# ========================
# 复制集配置（单机部署暂不启用）
# ========================
# replication:
#   replSetName: rs0

# ========================
# 分片配置（单机部署暂不启用）
# ========================
# sharding:
#   clusterRole: shardsvr
